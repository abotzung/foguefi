#!/bin/bash

#. /usr/share/fog/lib/funcs.sh
. /usr/share/foguefi/funcs.sh

# --v-- Determine if this script is launched via inittab or ttyd/command-line 
#       and export the variable. HOOK_* can read this variable after
if [[ "$1" == "--run-as-service" ]]; then export _run_as_service='1'; else export _run_as_service='0'; fi

export DIALOGRC="/root/dialog_jaune"
# shellcheck disable=SC2218
login_fog
if [[ $? -ne 0 ]]; then
    # Pas d'authentification / authentification échouée ? AU REVOIR !
    exit 1
fi

# *** DESTROY AUTH VARIABLES ***
# -> It is really necesarry ? 
export FOG_islogged=0
export FOG_username=''
export FOG_password=''

export DIALOGRC="/root/dialog_jaune"
/usr/share/bashconsole/bashconsole.sh -f "/usr/share/foguefi/adminmenu/" -q

exit 0
